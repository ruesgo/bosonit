{"version":"NotebookV1","origId":863457601242046,"name":"2-2 M&M Count","language":"scala","commands":[{"version":"CommandV1","origId":863457601242047,"guid":"e7b80e7c-38d3-460e-9bc6-4e98d0be881b","subtype":"command","commandType":"auto","position":1.0,"command":"\n%md\n## Ejemplo 2-1 M&M Count","commandVersion":3,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"nuid":"355c4241-003e-494e-aed4-bb69da2bf416"},{"version":"CommandV1","origId":863457601242048,"guid":"5949354e-eaea-4467-b30f-c5c97d76f259","subtype":"command","commandType":"auto","position":2.0,"command":"import org.apache.spark.sql.functions._\n\nval mnmFile = \"/databricks-datasets/learning-spark-v2/mnm_dataset.csv\"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions._\nmnmFile: String = /databricks-datasets/learning-spark-v2/mnm_dataset.csv\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1651226453532,"submitTime":1651226453277,"finishTime":1651226454050,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",140]],"subcommandOptions":null,"nuid":"a1c4c7c4-061d-4d77-8d13-e71b41866438"},{"version":"CommandV1","origId":863457601242049,"guid":"6c7636d7-0aa0-4dbb-8c8b-3c43084a0ce1","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n### Leer el CSV y sacar el esquema","commandVersion":13,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"nuid":"3ea7c846-d298-4e26-9a32-faeca62f59a3"},{"version":"CommandV1","origId":863457601242050,"guid":"8babda0a-606b-4f01-96b3-4ab034fd31cf","subtype":"command","commandType":"auto","position":4.0,"command":"val mnmDF = spark\n  .read\n  .format(\"csv\")\n  .option(\"header\", \"true\")\n  .option(\"inferSchema\", \"true\")\n  .load(mnmFile)\n\ndisplay(mnmDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["TX","Red",20],["NV","Blue",66],["CO","Blue",79],["OR","Blue",71],["WA","Yellow",93],["WY","Blue",16],["CA","Yellow",53],["WA","Green",60],["OR","Green",71],["TX","Green",68],["NV","Green",59],["AZ","Brown",95],["WA","Yellow",20],["AZ","Blue",75],["OR","Brown",72],["NV","Red",98],["WY","Orange",45],["CO","Blue",52],["TX","Brown",94],["CO","Red",82],["CO","Red",12],["CO","Red",17],["OR","Green",16],["AZ","Green",46],["NV","Red",43],["NM","Yellow",15],["WA","Red",12],["OR","Green",13],["CO","Blue",95],["WY","Red",63],["TX","Orange",63],["WY","Yellow",48],["OR","Green",95],["WA","Red",75],["CO","Orange",93],["NV","Orange",10],["WY","Green",15],["WA","Green",99],["CO","Blue",98],["CA","Green",86],["UT","Red",92],["AZ","Brown",16],["CA","Red",100],["UT","Red",77],["TX","Yellow",29],["WA","Orange",73],["WY","Yellow",56],["WA","Yellow",19],["WY","Yellow",18],["AZ","Orange",49],["WA","Red",83],["AZ","Red",59],["CA","Blue",13],["CO","Brown",53],["CA","Red",23],["CA","Yellow",49],["NV","Blue",50],["CO","Red",81],["UT","Green",62],["NM","Green",38],["NV","Yellow",77],["TX","Blue",49],["WA","Brown",20],["OR","Green",59],["OR","Red",66],["CA","Blue",34],["UT","Blue",97],["AZ","Blue",59],["OR","Blue",29],["CO","Red",17],["AZ","Orange",54],["TX","Green",69],["NM","Brown",65],["WY","Orange",23],["NM","Green",42],["OR","Green",39],["WA","Orange",84],["UT","Yellow",72],["NV","Yellow",98],["TX","Yellow",20],["UT","Brown",58],["CA","Red",67],["CO","Orange",42],["WA","Red",70],["OR","Blue",54],["TX","Green",85],["WY","Brown",85],["UT","Green",97],["CO","Blue",52],["WA","Yellow",43],["WA","Yellow",77],["WA","Green",10],["TX","Red",97],["WA","Brown",21],["WY","Red",22],["WY","Yellow",42],["WA","Orange",30],["NV","Orange",48],["WA","Blue",59],["CO","Orange",22],["CA","Orange",25],["CA","Yellow",69],["WY","Blue",59],["UT","Brown",77],["TX","Green",82],["CA","Orange",91],["TX","Brown",96],["WY","Blue",53],["WA","Blue",42],["TX","Green",74],["AZ","Brown",79],["OR","Orange",85],["CO","Orange",21],["AZ","Yellow",48],["WA","Blue",37],["NV","Blue",49],["CA","Brown",95],["CO","Brown",53],["TX","Red",16],["CO","Brown",56],["NV","Red",90],["WY","Brown",87],["UT","Yellow",56],["NM","Yellow",21],["CA","Yellow",41],["CA","Orange",71],["UT","Yellow",97],["CA","Brown",58],["WY","Brown",43],["NM","Blue",15],["AZ","Yellow",72],["WA","Brown",38],["CO","Green",44],["NV","Brown",65],["AZ","Yellow",94],["NV","Red",94],["CA","Brown",92],["WA","Orange",94],["AZ","Orange",53],["WY","Green",18],["NM","Orange",69],["CA","Blue",39],["NM","Green",32],["WA","Green",68],["AZ","Green",77],["UT","Red",46],["NM","Green",87],["CO","Red",78],["UT","Blue",48],["NV","Brown",10],["NM","Orange",77],["UT","Green",60],["WA","Yellow",49],["OR","Orange",18],["OR","Yellow",72],["CO","Orange",41],["AZ","Blue",82],["UT","Brown",78],["UT","Orange",24],["UT","Green",97],["WA","Brown",26],["CO","Brown",98],["CO","Blue",14],["WY","Yellow",78],["UT","Orange",34],["WA","Blue",18],["CO","Blue",89],["TX","Blue",80],["UT","Yellow",81],["NM","Yellow",75],["WY","Green",10],["CO","Red",79],["UT","Brown",98],["WA","Blue",84],["NM","Blue",46],["AZ","Blue",16],["WA","Brown",17],["TX","Blue",68],["NM","Green",67],["AZ","Green",89],["OR","Brown",48],["WY","Green",91],["WA","Brown",52],["AZ","Green",29],["WY","Brown",30],["NM","Red",50],["NV","Brown",49],["CA","Blue",99],["WY","Orange",81],["UT","Green",41],["OR","Brown",35],["TX","Red",13],["WY","Blue",80],["OR","Green",76],["CO","Yellow",74],["UT","Green",33],["TX","Brown",55],["CO","Green",22],["WY","Orange",99],["TX","Orange",93],["TX","Yellow",83],["OR","Green",77],["CO","Yellow",37],["CO","Blue",44],["CA","Brown",80],["WY","Brown",36],["WA","Brown",26],["NV","Green",49],["AZ","Red",93],["TX","Yellow",19],["CO","Yellow",63],["TX","Yellow",81],["TX","Red",100],["CA","Red",45],["UT","Brown",59],["NM","Brown",66],["TX","Red",95],["OR","Yellow",28],["AZ","Yellow",83],["CO","Red",52],["NV","Red",23],["WA","Green",27],["WY","Yellow",90],["NM","Yellow",29],["CA","Green",73],["NV","Brown",34],["CA","Orange",32],["TX","Red",44],["WA","Brown",76],["CO","Blue",90],["CO","Red",82],["NV","Orange",58],["NM","Red",40],["TX","Blue",19],["NV","Orange",84],["NM","Green",61],["UT","Brown",92],["AZ","Orange",50],["AZ","Yellow",49],["CA","Blue",65],["NM","Red",50],["WA","Yellow",57],["TX","Yellow",64],["CO","Red",94],["AZ","Yellow",80],["TX","Blue",98],["OR","Brown",48],["NM","Blue",98],["AZ","Yellow",80],["OR","Orange",91],["CA","Brown",64],["OR","Green",39],["NV","Yellow",76],["NM","Red",53],["UT","Yellow",35],["AZ","Blue",24],["WY","Red",87],["WY","Green",57],["NM","Red",47],["CO","Brown",57],["WY","Green",97],["WA","Yellow",31],["WY","Brown",81],["CA","Red",27],["WA","Yellow",58],["NM","Orange",70],["WY","Green",39],["WA","Red",38],["NM","Brown",99],["CA","Brown",94],["CO","Yellow",14],["CO","Green",25],["NV","Red",52],["WY","Brown",48],["NV","Orange",65],["AZ","Yellow",41],["WY","Green",68],["UT","Green",23],["WA","Green",58],["NM","Orange",41],["WY","Orange",56],["WY","Red",70],["CO","Green",58],["UT","Orange",36],["CA","Red",50],["WA","Red",10],["CA","Yellow",42],["AZ","Green",99],["NM","Brown",36],["UT","Green",77],["TX","Green",91],["WA","Orange",91],["OR","Brown",16],["CA","Orange",87],["TX","Yellow",70],["WA","Green",29],["NM","Blue",70],["TX","Red",55],["WY","Green",86],["OR","Blue",96],["OR","Blue",37],["WY","Blue",33],["NM","Green",83],["UT","Orange",87],["WY","Yellow",62],["WY","Red",23],["TX","Brown",59],["CO","Green",40],["CA","Brown",41],["AZ","Brown",90],["WA","Yellow",92],["OR","Green",76],["WA","Blue",46],["CA","Red",52],["NM","Blue",52],["WY","Orange",63],["OR","Green",14],["AZ","Yellow",23],["CA","Brown",84],["NM","Orange",46],["WY","Green",100],["CA","Red",49],["UT","Brown",67],["UT","Brown",52],["AZ","Brown",41],["OR","Blue",20],["CA","Yellow",94],["CO","Blue",27],["CA","Yellow",89],["NM","Blue",82],["UT","Yellow",26],["AZ","Green",35],["UT","Green",72],["CA","Yellow",66],["WY","Yellow",58],["NV","Yellow",96],["WY","Green",36],["WA","Brown",35],["CA","Green",39],["CA","Red",71],["OR","Brown",93],["OR","Blue",74],["UT","Green",42],["NM","Yellow",34],["NM","Red",22],["WY","Green",48],["WY","Yellow",59],["CA","Blue",43],["UT","Blue",21],["WA","Brown",96],["WA","Blue",62],["CO","Red",22],["NM","Blue",70],["TX","Green",83],["OR","Brown",65],["NM","Red",34],["TX","Brown",12],["UT","Green",86],["UT","Yellow",28],["OR","Red",53],["TX","Brown",37],["WA","Blue",37],["UT","Red",35],["CO","Orange",72],["AZ","Blue",19],["UT","Blue",94],["OR","Brown",61],["UT","Orange",77],["TX","Red",45],["NV","Brown",72],["NM","Blue",81],["AZ","Yellow",39],["OR","Yellow",28],["WA","Green",40],["UT","Orange",60],["TX","Blue",41],["TX","Green",93],["CA","Orange",72],["CO","Orange",99],["NV","Blue",89],["TX","Blue",76],["AZ","Green",79],["TX","Blue",59],["NM","Green",20],["CA","Yellow",32],["OR","Blue",95],["NM","Orange",96],["NM","Red",57],["UT","Blue",65],["WY","Blue",35],["WY","Blue",24],["UT","Orange",58],["TX","Orange",77],["WA","Blue",14],["CO","Blue",27],["CA","Blue",23],["WY","Brown",20],["CO","Blue",17],["WA","Yellow",14],["CA","Green",61],["CO","Brown",90],["AZ","Yellow",76],["WY","Red",85],["CO","Blue",22],["UT","Brown",50],["WY","Orange",75],["OR","Yellow",25],["OR","Green",76],["CA","Blue",99],["CO","Green",27],["NV","Orange",45],["OR","Red",80],["UT","Yellow",92],["WA","Brown",16],["AZ","Brown",39],["NM","Blue",13],["CO","Yellow",17],["UT","Orange",55],["OR","Red",49],["AZ","Green",36],["AZ","Yellow",37],["CA","Red",34],["WY","Blue",57],["TX","Blue",60],["UT","Yellow",99],["WY","Green",23],["CA","Green",53],["AZ","Brown",43],["TX","Orange",18],["CO","Green",54],["NV","Red",92],["TX","Blue",91],["AZ","Orange",77],["WA","Brown",58],["TX","Orange",73],["WY","Blue",62],["CA","Blue",89],["AZ","Green",92],["WY","Brown",67],["AZ","Yellow",14],["UT","Brown",56],["TX","Orange",28],["UT","Brown",19],["WA","Blue",42],["NM","Yellow",30],["WY","Orange",81],["CO","Brown",72],["NM","Blue",21],["CA","Blue",65],["AZ","Blue",38],["AZ","Orange",39],["AZ","Brown",42],["NV","Orange",21],["CO","Brown",26],["WY","Orange",15],["CO","Red",67],["UT","Yellow",34],["AZ","Yellow",71],["NV","Blue",12],["AZ","Green",25],["NM","Red",65],["OR","Orange",20],["NM","Red",14],["CO","Orange",79],["TX","Orange",99],["AZ","Green",58],["WA","Brown",12],["UT","Brown",60],["CO","Red",93],["UT","Brown",72],["AZ","Orange",88],["CA","Yellow",34],["WY","Yellow",32],["NM","Green",99],["OR","Blue",89],["TX","Yellow",60],["TX","Green",45],["OR","Yellow",40],["WA","Red",66],["CO","Yellow",43],["WA","Blue",47],["WA","Green",83],["WA","Orange",37],["WY","Yellow",36],["UT","Blue",19],["NM","Orange",11],["TX","Yellow",15],["WA","Orange",41],["CO","Red",90],["TX","Yellow",52],["NV","Red",72],["NM","Yellow",52],["WA","Green",37],["OR","Yellow",82],["CO","Green",31],["NV","Yellow",99],["WA","Brown",91],["AZ","Orange",50],["CA","Blue",42],["TX","Yellow",15],["WY","Blue",65],["NM","Green",64],["CO","Orange",29],["WA","Orange",61],["UT","Red",83],["CO","Blue",73],["WA","Blue",42],["WA","Brown",59],["OR","Brown",79],["CO","Green",26],["OR","Red",92],["WY","Green",23],["NV","Red",39],["CA","Orange",70],["UT","Orange",14],["CA","Orange",10],["NM","Green",82],["WA","Blue",15],["TX","Red",91],["UT","Red",88],["WY","Red",10],["WA","Yellow",74],["WA","Green",96],["CO","Blue",47],["NV","Blue",13],["UT","Blue",52],["CO","Orange",65],["OR","Orange",33],["CO","Yellow",77],["CO","Orange",19],["OR","Brown",89],["CA","Red",83],["NM","Brown",75],["NV","Orange",38],["WY","Green",95],["AZ","Green",54],["NM","Orange",22],["TX","Orange",82],["CO","Yellow",72],["TX","Yellow",67],["UT","Blue",19],["OR","Red",55],["AZ","Brown",69],["TX","Blue",26],["CA","Brown",34],["CA","Orange",48],["AZ","Orange",64],["WY","Green",62],["NV","Brown",41],["WA","Green",31],["CA","Red",57],["WA","Brown",53],["CA","Orange",71],["NV","Brown",69],["TX","Orange",25],["NV","Red",59],["TX","Orange",86],["WA","Yellow",70],["UT","Green",16],["UT","Blue",87],["UT","Brown",23],["TX","Green",98],["CA","Green",28],["TX","Blue",86],["WY","Green",68],["NV","Brown",35],["CO","Blue",13],["CO","Orange",89],["CA","Orange",66],["WA","Yellow",84],["OR","Green",64],["OR","Red",45],["UT","Green",65],["WY","Orange",21],["TX","Brown",18],["UT","Orange",59],["UT","Green",49],["NV","Orange",98],["CA","Green",48],["CA","Yellow",25],["CO","Red",44],["UT","Yellow",85],["NM","Brown",30],["NM","Brown",89],["OR","Brown",40],["NM","Yellow",58],["TX","Yellow",31],["OR","Orange",33],["NM","Green",24],["NM","Orange",70],["AZ","Brown",93],["CA","Orange",96],["NV","Brown",36],["WY","Yellow",49],["WA","Yellow",34],["TX","Red",64],["TX","Blue",99],["CO","Green",34],["CO","Blue",12],["NM","Yellow",10],["NM","Orange",76],["NM","Red",57],["CA","Red",61],["CO","Yellow",82],["UT","Blue",99],["WY","Red",80],["WA","Orange",51],["TX","Orange",86],["CO","Green",20],["WA","Brown",10],["WA","Yellow",40],["AZ","Orange",22],["NM","Green",61],["CA","Blue",27],["NM","Blue",23],["UT","Green",35],["UT","Orange",59],["TX","Yellow",32],["WA","Yellow",78],["AZ","Brown",35],["WA","Blue",22],["OR","Orange",63],["WA","Orange",92],["WY","Green",78],["CA","Orange",35],["AZ","Red",92],["CA","Red",14],["WA","Red",52],["UT","Blue",22],["CA","Yellow",57],["AZ","Yellow",30],["CA","Green",77],["WY","Yellow",67],["NV","Yellow",95],["AZ","Brown",26],["AZ","Red",58],["WY","Brown",14],["TX","Orange",52],["CO","Orange",95],["NV","Green",91],["OR","Brown",86],["WY","Red",19],["TX","Brown",78],["WY","Orange",87],["CA","Red",91],["NV","Brown",50],["CO","Brown",28],["AZ","Orange",50],["UT","Brown",41],["CO","Yellow",66],["UT","Brown",76],["OR","Red",30],["NM","Brown",30],["UT","Orange",21],["WY","Blue",48],["AZ","Green",49],["TX","Brown",32],["NV","Blue",71],["NV","Yellow",83],["OR","Yellow",85],["AZ","Green",35],["WY","Red",81],["WY","Orange",76],["UT","Green",42],["WA","Red",17],["AZ","Brown",81],["TX","Blue",90],["AZ","Red",57],["WA","Green",32],["NM","Yellow",66],["UT","Orange",43],["TX","Yellow",14],["WA","Orange",61],["NV","Yellow",62],["WA","Green",16],["OR","Yellow",33],["TX","Orange",66],["UT","Orange",40],["UT","Red",100],["TX","Orange",28],["NV","Orange",26],["WA","Red",33],["AZ","Blue",85],["NV","Red",100],["NV","Brown",64],["WA","Yellow",71],["NV","Green",94],["WA","Brown",46],["UT","Yellow",27],["OR","Green",90],["WA","Yellow",41],["CA","Green",38],["WA","Orange",93],["OR","Yellow",82],["WY","Red",16],["WA","Brown",32],["WY","Blue",38],["TX","Yellow",96],["WY","Blue",58],["WA","Green",37],["WA","Yellow",35],["NV","Yellow",66],["OR","Blue",31],["AZ","Green",15],["NV","Blue",34],["WY","Green",24],["NM","Brown",16],["NV","Orange",50],["WY","Blue",28],["NM","Blue",29],["TX","Yellow",37],["CO","Brown",30],["OR","Orange",91],["TX","Yellow",35],["NM","Orange",20],["CA","Blue",19],["CO","Red",64],["CA","Brown",72],["TX","Brown",67],["WA","Green",64],["WY","Blue",24],["OR","Brown",84],["WA","Brown",78],["AZ","Green",61],["TX","Yellow",51],["WY","Yellow",23],["CO","Red",87],["OR","Blue",78],["UT","Brown",99],["CO","Red",24],["NM","Red",43],["NM","Green",66],["UT","Yellow",82],["WA","Red",28],["WY","Brown",28],["AZ","Red",65],["NV","Yellow",58],["UT","Brown",84],["CO","Yellow",11],["NM","Yellow",29],["OR","Blue",17],["WA","Yellow",56],["CO","Yellow",43],["CO","Orange",43],["UT","Orange",32],["OR","Brown",86],["OR","Green",94],["TX","Green",94],["NV","Orange",54],["AZ","Red",99],["TX","Red",54],["CA","Green",57],["UT","Brown",88],["AZ","Red",59],["UT","Red",93],["CA","Green",61],["NV","Yellow",60],["OR","Red",98],["WY","Red",37],["WA","Blue",42],["WY","Yellow",89],["CA","Green",98],["TX","Orange",36],["UT","Brown",68],["WA","Red",93],["NV","Orange",84],["NV","Green",93],["OR","Yellow",52],["OR","Red",87],["UT","Green",50],["NM","Red",64],["TX","Blue",59],["AZ","Brown",81],["WA","Brown",96],["CO","Orange",80],["NM","Brown",25],["NV","Blue",57],["CA","Blue",88],["AZ","Blue",69],["UT","Yellow",54],["UT","Red",80],["CA","Yellow",92],["NM","Blue",36],["WA","Green",54],["WA","Blue",67],["AZ","Brown",39],["NV","Green",32],["NV","Green",27],["UT","Yellow",93],["CA","Orange",18],["WA","Yellow",37],["TX","Blue",11],["CA","Yellow",69],["CO","Orange",43],["OR","Brown",88],["NM","Brown",24],["CA","Red",39],["CO","Yellow",16],["WY","Orange",49],["OR","Red",73],["UT","Blue",38],["TX","Green",87],["AZ","Orange",89],["NM","Green",88],["WY","Brown",25],["WY","Red",24],["NV","Yellow",61],["WY","Blue",43],["UT","Orange",22],["WA","Brown",97],["UT","Red",57],["WY","Red",95],["AZ","Blue",63],["WY","Red",17],["CO","Brown",99],["OR","Orange",43],["CO","Blue",51],["TX","Blue",41],["NM","Red",15],["WA","Blue",16],["CO","Green",46],["WA","Red",13],["CA","Blue",81],["NM","Green",84],["AZ","Blue",88],["UT","Yellow",100],["UT","Yellow",57],["WY","Brown",34],["AZ","Brown",25],["WA","Orange",59],["OR","Orange",74],["CO","Orange",24],["CO","Yellow",69],["CO","Blue",43],["TX","Green",36],["NV","Blue",62],["NV","Brown",29],["AZ","Yellow",98],["WA","Brown",10],["WY","Red",36],["NV","Green",36],["CA","Red",12],["CO","Blue",44],["UT","Orange",89],["NV","Red",24],["WA","Yellow",95],["NM","Brown",86],["OR","Brown",29],["TX","Orange",41],["WA","Orange",14],["CO","Brown",87],["CO","Orange",96],["WA","Yellow",91],["AZ","Green",24],["UT","Green",13],["NM","Green",13],["NM","Brown",58],["OR","Orange",18],["WA","Yellow",83],["UT","Brown",82],["WA","Brown",59],["WY","Blue",58],["TX","Yellow",98],["WY","Orange",56],["TX","Yellow",79],["CO","Blue",99],["CO","Brown",62],["WA","Orange",92],["CA","Brown",16],["UT","Blue",34],["NM","Red",88],["NM","Yellow",95],["NM","Blue",76],["WY","Red",46],["WA","Red",89],["WY","Brown",78],["TX","Yellow",59],["CO","Yellow",21],["CO","Brown",85],["CO","Orange",15],["AZ","Orange",85],["AZ","Yellow",85],["NM","Green",68],["WY","Blue",50],["UT","Yellow",93],["TX","Brown",88],["NV","Brown",10],["UT","Yellow",37],["NM","Green",54],["NV","Red",68],["AZ","Orange",61],["NM","Yellow",73],["NV","Red",98],["TX","Red",98],["CA","Orange",47],["NV","Red",18],["WY","Brown",15],["TX","Yellow",89],["TX","Brown",27],["TX","Red",10],["NM","Yellow",63],["WA","Green",70],["TX","Yellow",86],["WA","Brown",55],["NM","Yellow",48],["CA","Red",67],["TX","Orange",35],["AZ","Blue",85],["AZ","Green",44],["WA","Green",99],["WY","Blue",90],["UT","Brown",66],["TX","Brown",69],["TX","Orange",47],["AZ","Red",75],["OR","Blue",59],["WA","Orange",55],["WA","Orange",93],["WA","Green",20],["WY","Brown",76],["CO","Yellow",33],["NM","Blue",95],["TX","Green",59],["WA","Brown",21],["AZ","Yellow",19],["UT","Brown",18],["UT","Brown",82],["NV","Blue",97],["NV","Yellow",96],["NV","Green",41],["UT","Red",16],["CA","Yellow",71],["NV","Blue",18],["TX","Green",16],["CA","Red",22],["CA","Brown",96],["CO","Blue",26],["CA","Red",28],["TX","Brown",94],["AZ","Green",54],["TX","Green",14],["NM","Red",58],["WA","Red",49],["AZ","Yellow",83],["NV","Blue",58],["TX","Blue",94],["WY","Yellow",100],["TX","Brown",39],["UT","Green",19],["NV","Orange",17],["NM","Brown",59],["CO","Green",86],["AZ","Brown",68],["AZ","Brown",29],["NM","Red",57],["CO","Brown",15],["AZ","Orange",45],["WA","Blue",96],["OR","Brown",48],["UT","Brown",59],["WY","Orange",84],["WA","Yellow",45],["WY","Green",52],["UT","Red",90],["CO","Red",22],["TX","Brown",92],["WA","Yellow",92],["UT","Yellow",53],["UT","Orange",82],["UT","Red",91],["NM","Green",27],["NV","Green",96],["WA","Red",32],["CA","Brown",90],["WY","Blue",18],["NV","Orange",86],["NV","Red",34],["NV","Brown",30],["WY","Green",57],["UT","Red",84],["NM","Green",45],["UT","Yellow",31],["UT","Yellow",80],["OR","Red",79],["UT","Brown",15],["NV","Orange",51],["CO","Brown",73],["UT","Yellow",67],["WA","Brown",88],["CA","Yellow",60],["TX","Orange",34],["WA","Red",92],["WA","Brown",68],["NV","Orange",18],["WY","Brown",60],["NV","Red",52],["TX","Green",45],["WA","Red",82],["WA","Green",29],["UT","Red",34]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"State","type":"\"string\"","metadata":"{}"},{"name":"Color","type":"\"string\"","metadata":"{}"},{"name":"Count","type":"\"integer\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[{"name":"mnmDF","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"State","type":"string","nullable":true,"metadata":{}},{"name":"Color","type":"string","nullable":true,"metadata":{}},{"name":"Count","type":"integer","nullable":true,"metadata":{}}]},"tableIdentifier":null}],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1651226454062,"submitTime":1651226453295,"finishTime":1651226457461,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"371","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",null]],"subcommandOptions":null,"nuid":"2206462e-80d2-48e1-bdc6-1d803705864f"},{"version":"CommandV1","origId":863457601242051,"guid":"996fb12f-d479-4c15-a298-7399b40ac670","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n### Añadir el count de todos los colores y agrupar por estado y color, ordenar por orden descendiente","commandVersion":35,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"nuid":"eee77d49-8b4b-4350-bfd1-999bc6c05b41"},{"version":"CommandV1","origId":863457601242052,"guid":"4deaf2e4-91ed-4da1-8f0c-59bc393ffba1","subtype":"command","commandType":"auto","position":6.0,"command":"val countMnMDF = mnmDF\n  .select(\"State\", \"Color\", \"Count\")\n  .groupBy(\"State\", \"Color\")\n  .agg(count(\"Count\")\n  .alias(\"Total\"))\n  .orderBy(desc(\"Total\"))\n\ncountMnMDF.show(60)\nprintln(s\"Total Rows = ${countMnMDF.count()}\") //utilizando la s se aplica la función ","commandVersion":21,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+------+-----+\n|State| Color|Total|\n+-----+------+-----+\n|   CA|Yellow| 1807|\n|   WA| Green| 1779|\n|   OR|Orange| 1743|\n|   TX| Green| 1737|\n|   TX|   Red| 1725|\n|   CA| Green| 1723|\n|   CO|Yellow| 1721|\n|   CA| Brown| 1718|\n|   CO| Green| 1713|\n|   NV|Orange| 1712|\n|   TX|Yellow| 1703|\n|   NV| Green| 1698|\n|   AZ| Brown| 1698|\n|   WY| Green| 1695|\n|   CO|  Blue| 1695|\n|   NM|   Red| 1690|\n|   AZ|Orange| 1689|\n|   NM|Yellow| 1688|\n|   NM| Brown| 1687|\n|   UT|Orange| 1684|\n|   NM| Green| 1682|\n|   UT|   Red| 1680|\n|   AZ| Green| 1676|\n|   NV|Yellow| 1675|\n|   NV|  Blue| 1673|\n|   WA|   Red| 1671|\n|   WY|   Red| 1670|\n|   WA| Brown| 1669|\n|   NM|Orange| 1665|\n|   WY|  Blue| 1664|\n|   WA|Yellow| 1663|\n|   WA|Orange| 1658|\n|   CA|Orange| 1657|\n|   NV| Brown| 1657|\n|   CA|   Red| 1656|\n|   CO| Brown| 1656|\n|   UT|  Blue| 1655|\n|   AZ|Yellow| 1654|\n|   TX|Orange| 1652|\n|   AZ|   Red| 1648|\n|   OR|  Blue| 1646|\n|   UT|Yellow| 1645|\n|   OR|   Red| 1645|\n|   CO|Orange| 1642|\n|   TX| Brown| 1641|\n|   NM|  Blue| 1638|\n|   AZ|  Blue| 1636|\n|   OR| Green| 1634|\n|   UT| Brown| 1631|\n|   WY|Yellow| 1626|\n|   WA|  Blue| 1625|\n|   CO|   Red| 1624|\n|   OR| Brown| 1621|\n|   TX|  Blue| 1614|\n|   OR|Yellow| 1614|\n|   NV|   Red| 1610|\n|   CA|  Blue| 1603|\n|   WY|Orange| 1595|\n|   UT| Green| 1591|\n|   WY| Brown| 1532|\n+-----+------+-----+\n\nTotal Rows = 60\ncountMnMDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [State: string, Color: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"countMnMDF","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"State","type":"string","nullable":true,"metadata":{}},{"name":"Color","type":"string","nullable":true,"metadata":{}},{"name":"Total","type":"long","nullable":false,"metadata":{}}]},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1651226457475,"submitTime":1651226453315,"finishTime":1651226462207,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",1505]],"subcommandOptions":null,"nuid":"d388a96c-52ae-4991-a6e1-89f270c20b75"},{"version":"CommandV1","origId":863457601242053,"guid":"875b89b9-ca98-4055-94d7-4f5561578f5f","subtype":"command","commandType":"auto","position":7.0,"command":"%md\n### Encontrar count para California filtrando por estado","commandVersion":15,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"nuid":"5ec3ef45-e89c-4aa9-a575-68117c98dcfb"},{"version":"CommandV1","origId":863457601242054,"guid":"54893942-bd6c-46c9-babc-541f39c48e3a","subtype":"command","commandType":"auto","position":8.0,"command":"val caCountMnMDF = mnmDF\n  .select(\"State\", \"Color\", \"Count\")\n  .where(col(\"State\") === \"CA\")\n  .groupBy(\"State\", \"Color\")\n  .agg(count(\"Count\").alias(\"Total\"))\n  .orderBy(desc(\"Total\"))\n   \n// show the resulting aggregation for California\ncaCountMnMDF.show(10)","commandVersion":5,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+------+-----+\n|State| Color|Total|\n+-----+------+-----+\n|   CA|Yellow| 1807|\n|   CA| Green| 1723|\n|   CA| Brown| 1718|\n|   CA|Orange| 1657|\n|   CA|   Red| 1656|\n|   CA|  Blue| 1603|\n+-----+------+-----+\n\ncaCountMnMDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [State: string, Color: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"caCountMnMDF","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"State","type":"string","nullable":true,"metadata":{}},{"name":"Color","type":"string","nullable":true,"metadata":{}},{"name":"Total","type":"long","nullable":false,"metadata":{}}]},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1651226462222,"submitTime":1651226453337,"finishTime":1651226464710,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",357]],"subcommandOptions":null,"nuid":"cd4722dd-65df-4de8-a48c-1b52c5f7223a"},{"version":"CommandV1","origId":863457601242533,"guid":"d568d1bc-7153-4c99-9779-70c4fb5c2c65","subtype":"command","commandType":"auto","position":9.0,"command":"val maxMnMDF = mnmDF\n  .select(\"State\", \"Color\", \"Count\")\n  .groupBy(\"State\", \"Color\")\n  .agg(max(\"Count\")\n  .alias(\"Max\"))\n  .orderBy(\"Max\")\n\nmaxMnMDF.show(60)","commandVersion":21,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+------+---+\n|State| Color|Max|\n+-----+------+---+\n|   WY| Green|100|\n|   NV|   Red|100|\n|   UT|  Blue|100|\n|   WA|Orange|100|\n|   NM| Green|100|\n|   CA|  Blue|100|\n|   WA|   Red|100|\n|   NV| Brown|100|\n|   AZ| Green|100|\n|   CA|   Red|100|\n|   AZ|Orange|100|\n|   CO|  Blue|100|\n|   NM|Orange|100|\n|   NM|Yellow|100|\n|   WY|Orange|100|\n|   UT|Yellow|100|\n|   WY|   Red|100|\n|   OR|  Blue|100|\n|   NV|Orange|100|\n|   AZ|Yellow|100|\n|   OR| Green|100|\n|   AZ|  Blue|100|\n|   WA| Green|100|\n|   CO|Yellow|100|\n|   CO| Brown|100|\n|   UT| Green|100|\n|   CA|Yellow|100|\n|   WY| Brown|100|\n|   NV|  Blue|100|\n|   NM|  Blue|100|\n|   OR|Orange|100|\n|   NM|   Red|100|\n|   NV| Green|100|\n|   CA|Orange|100|\n|   WA|  Blue|100|\n|   AZ|   Red|100|\n|   TX|  Blue|100|\n|   UT|Orange|100|\n|   TX|Orange|100|\n|   WA| Brown|100|\n|   UT| Brown|100|\n|   TX| Green|100|\n|   OR|   Red|100|\n|   TX|   Red|100|\n|   NV|Yellow|100|\n|   CO|   Red|100|\n|   TX| Brown|100|\n|   TX|Yellow|100|\n|   UT|   Red|100|\n|   CO| Green|100|\n|   WY|  Blue|100|\n|   CA| Brown|100|\n|   CO|Orange|100|\n|   CA| Green|100|\n|   OR| Brown|100|\n|   WY|Yellow|100|\n|   OR|Yellow|100|\n|   NM| Brown|100|\n|   AZ| Brown|100|\n|   WA|Yellow|100|\n+-----+------+---+\n\nmaxMnMDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [State: string, Color: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"maxMnMDF","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"State","type":"string","nullable":true,"metadata":{}},{"name":"Color","type":"string","nullable":true,"metadata":{}},{"name":"Max","type":"integer","nullable":true,"metadata":{}}]},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1651226464722,"submitTime":1651226453361,"finishTime":1651226467802,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",1359]],"subcommandOptions":null,"nuid":"05a29b8b-eedf-4473-8b36-327d4edea825"},{"version":"CommandV1","origId":2887067133810794,"guid":"3c8baf18-8ba5-41fa-82c6-71be99cbd2b4","subtype":"command","commandType":"auto","position":10.0,"command":"val txMaxMnMDF = mnmDF\n  .select(\"State\", \"Color\", \"Count\")\n  .where(col(\"State\") === \"TX\")\n  .groupBy(\"State\", \"Color\")\n  .agg(max(\"Count\")\n  .alias(\"Max\"))\n  .orderBy(\"Max\")\n\ntxMaxMnMDF.show(60)","commandVersion":12,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+------+---+\n|State| Color|Max|\n+-----+------+---+\n|   TX|  Blue|100|\n|   TX|Orange|100|\n|   TX| Green|100|\n|   TX|   Red|100|\n|   TX| Brown|100|\n|   TX|Yellow|100|\n+-----+------+---+\n\ntxMaxMnMDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [State: string, Color: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"txMaxMnMDF","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"State","type":"string","nullable":true,"metadata":{}},{"name":"Color","type":"string","nullable":true,"metadata":{}},{"name":"Max","type":"integer","nullable":true,"metadata":{}}]},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1651226467816,"submitTime":1651226453385,"finishTime":1651226470175,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",335]],"subcommandOptions":null,"nuid":"0b57ad26-a466-4dbb-b9d6-75568fb1e567"},{"version":"CommandV1","origId":2887067133810795,"guid":"c935841b-33c3-4b68-9005-9268d5879935","subtype":"command","commandType":"auto","position":11.0,"command":"val totalMnMDF = mnmDF\n  .select(\"State\", \"Color\", \"Count\")\n  .groupBy(\"State\", \"Color\")\n  .agg(\n    max(\"Count\").alias(\"Max\"),\n    min(\"Count\").alias(\"Min\"),\n    avg(\"Count\").alias(\"Avg\"),\n    count(\"Count\").alias(\"Total\"),\n  )\n  .orderBy(desc(\"Avg\"))\n\ntotalMnMDF.show(60)","commandVersion":45,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+------+---+---+------------------+-----+\n|State| Color|Max|Min|               Avg|Total|\n+-----+------+---+---+------------------+-----+\n|   CO| Brown|100| 10| 56.57729468599034| 1656|\n|   WY| Brown|100| 10| 56.20757180156658| 1532|\n|   NM|   Red|100| 10| 56.03491124260355| 1690|\n|   TX|Orange|100| 10|55.880750605326874| 1652|\n|   WA|Yellow|100| 10|  55.8749248346362| 1663|\n|   CA|Yellow|100| 10|  55.8693967902601| 1807|\n|   WA|   Red|100| 10| 55.85397965290245| 1671|\n|   NV| Brown|100| 10| 55.81050090525045| 1657|\n|   WA| Brown|100| 10| 55.77112043139604| 1669|\n|   CA| Brown|100| 10|55.740395809080326| 1718|\n|   WY| Green|100| 10|55.657227138643066| 1695|\n|   CA|  Blue|100| 10| 55.59762944479102| 1603|\n|   UT| Green|100| 10|55.557510999371466| 1591|\n|   NV|   Red|100| 10|  55.4944099378882| 1610|\n|   CO|Orange|100| 10|55.402557856272836| 1642|\n|   NM| Brown|100| 10|55.392412566686424| 1687|\n|   WA|  Blue|100| 10|55.314461538461536| 1625|\n|   TX|   Red|100| 10|55.306666666666665| 1725|\n|   TX| Brown|100| 10| 55.29311395490554| 1641|\n|   CA|   Red|100| 10| 55.26992753623188| 1656|\n|   CO|Yellow|100| 10| 55.22254503195816| 1721|\n|   WA|Orange|100| 10|55.199638118214715| 1658|\n|   WY|Orange|100| 10|55.144827586206894| 1595|\n|   TX| Green|100| 10| 55.12550374208405| 1737|\n|   CO|  Blue|100| 10| 55.11032448377581| 1695|\n|   TX|Yellow|100| 10| 55.09042865531415| 1703|\n|   CO|   Red|100| 10|55.089285714285715| 1624|\n|   NM|  Blue|100| 10| 55.03663003663004| 1638|\n|   OR|  Blue|100| 10| 54.99756986634265| 1646|\n|   AZ|  Blue|100| 10| 54.99449877750611| 1636|\n|   OR| Brown|100| 10| 54.98827884022209| 1621|\n|   AZ|Yellow|100| 10| 54.98548972188634| 1654|\n|   WY|   Red|100| 10|54.950898203592814| 1670|\n|   NM|Yellow|100| 10| 54.94490521327014| 1688|\n|   OR|   Red|100| 10| 54.88510638297873| 1645|\n|   NV|Orange|100| 10|54.865070093457945| 1712|\n|   AZ| Green|100| 10| 54.82219570405728| 1676|\n|   OR| Green|100| 10|54.821297429620564| 1634|\n|   TX|  Blue|100| 10|54.811648079306075| 1614|\n|   NM|Orange|100| 10|  54.8054054054054| 1665|\n|   CO| Green|100| 10| 54.71336835960304| 1713|\n|   WY|  Blue|100| 10| 54.68870192307692| 1664|\n|   AZ|   Red|100| 10|54.637135922330096| 1648|\n|   OR|Yellow|100| 10| 54.60285006195787| 1614|\n|   NV|Yellow|100| 10|54.561194029850746| 1675|\n|   UT| Brown|100| 10| 54.55119558553035| 1631|\n|   CA|Orange|100| 10|54.502715751357876| 1657|\n|   UT|  Blue|100| 10|54.366767371601206| 1655|\n|   AZ| Brown|100| 10|54.350412249705535| 1698|\n|   AZ|Orange|100| 10| 54.28300769686205| 1689|\n|   CA| Green|100| 10|54.268717353453276| 1723|\n|   UT|Yellow|100| 10|54.263829787234044| 1645|\n|   UT|Orange|100| 10| 54.24049881235155| 1684|\n|   WA| Green|100| 10| 54.23608768971332| 1779|\n|   OR|Orange|100| 10| 54.22489959839358| 1743|\n|   NM| Green|100| 10|  54.1973840665874| 1682|\n|   UT|   Red|100| 10|54.163690476190474| 1680|\n|   WY|Yellow|100| 10|53.997539975399754| 1626|\n|   NV|  Blue|100| 10|53.797369994022716| 1673|\n|   NV| Green|100| 10| 53.78739693757362| 1698|\n+-----+------+---+---+------------------+-----+\n\ntotalMnMDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [State: string, Color: string ... 4 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"totalMnMDF","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"State","type":"string","nullable":true,"metadata":{}},{"name":"Color","type":"string","nullable":true,"metadata":{}},{"name":"Max","type":"integer","nullable":true,"metadata":{}},{"name":"Min","type":"integer","nullable":true,"metadata":{}},{"name":"Avg","type":"double","nullable":true,"metadata":{}},{"name":"Total","type":"long","nullable":false,"metadata":{}}]},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1651226470185,"submitTime":1651226453411,"finishTime":1651226473049,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",3218]],"subcommandOptions":null,"nuid":"bb9351bc-12b5-427f-96a9-eca409198bc7"},{"version":"CommandV1","origId":2887067133810796,"guid":"ae627d60-a2b9-4a02-9daa-db029ffd9820","subtype":"command","commandType":"auto","position":8.5,"command":"%md\n### Primer ejercicio propuesto: \n  i. Agrupar por estado y color y calcular el máximo de la cuenta","commandVersion":52,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"nuid":"55332db5-5a87-47d7-8f6c-6fd06374e353"},{"version":"CommandV1","origId":2887067133810797,"guid":"4998689c-1db0-4434-b763-e31a10808f4e","subtype":"command","commandType":"auto","position":9.5,"command":"%md\n  ii. Acotar la búsqueda al estado de Texas con la claúsula where","commandVersion":31,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"nuid":"9281e656-0686-4276-bffd-f66546a8b83e"},{"version":"CommandV1","origId":2887067133810798,"guid":"02c567c8-fcda-4617-a2a4-c9a2deeb6c23","subtype":"command","commandType":"auto","position":10.5,"command":"%md\n  iii. Hacer un ejercicio donde se calculen en una misma operación el Max, Min, Avg, Count. Se odena por Avg","commandVersion":13,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"nuid":"c76fd617-4bd0-4d13-b4b6-45c85fbd8a1d"},{"version":"CommandV1","origId":2887067133810799,"guid":"143d1a4c-6f29-4a5b-90f2-c0f408ae9f07","subtype":"command","commandType":"auto","position":12.0,"command":"mnmDF.createOrReplaceTempView(\"df_temp\")\nspark.sql(\"select State, Color, avg(Count) as Avg from df_temp where State = 'CA' group by State, Color order by Avg desc\").show()","commandVersion":124,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+------+------------------+\n|State| Color|               Avg|\n+-----+------+------------------+\n|   CA|Yellow|  55.8693967902601|\n|   CA| Brown|55.740395809080326|\n|   CA|  Blue| 55.59762944479102|\n|   CA|   Red| 55.26992753623188|\n|   CA|Orange|54.502715751357876|\n|   CA| Green|54.268717353453276|\n+-----+------+------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1651228870350,"submitTime":1651228870339,"finishTime":1651228872445,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",368]],"subcommandOptions":null,"nuid":"c65c5e11-6504-4a2f-94f8-eeffe1782c1e"},{"version":"CommandV1","origId":2887067133810810,"guid":"5c89d84c-059b-41db-909f-0e90814e3712","subtype":"command","commandType":"auto","position":13.0,"command":"","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"nuid":"f553cff0-d0b7-4119-9054-e7dbc1a962a7"}],"dashboards":[],"guid":"ce80ac21-3ba6-40af-8d53-bd8c5da320b2","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2}}