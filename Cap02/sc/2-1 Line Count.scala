{"version":"NotebookV1","origId":863457601242055,"name":"2-1 Line Count","language":"scala","commands":[{"version":"CommandV1","origId":863457601242056,"guid":"fd4ff4f2-3609-48d3-b7a8-050ff29c5b3c","subtype":"command","commandType":"auto","position":1.0,"command":"\n%md\n## Ejemplo 2-1 Line Count","commandVersion":3,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"nuid":"8245b27e-267d-4b61-a329-bc2152bcb3ac"},{"version":"CommandV1","origId":863457601242057,"guid":"3e99128c-a76c-45b7-bfcf-4477637130a2","subtype":"command","commandType":"auto","position":2.0,"command":"%md\nSe lee el archivo, se cuentan las líneas y se hace un filtrado de las líneas en las que aparece la palabra 'spark'","commandVersion":43,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"nuid":"906fc620-770c-47f1-9bb9-14e8c06ef9a1"},{"version":"CommandV1","origId":863457601242058,"guid":"bdd93a25-5100-4a71-8620-799d821572e0","subtype":"command","commandType":"auto","position":3.0,"command":"val strings = spark.read.text(\"/databricks-datasets/learning-spark-v2/SPARK_README.md\")\nstrings.show(10, false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------------------------------------------------------------------------------+\n|value                                                                         |\n+------------------------------------------------------------------------------+\n|# Apache Spark                                                                |\n|                                                                              |\n|Spark is a fast and general cluster computing system for Big Data. It provides|\n|high-level APIs in Scala, Java, Python, and R, and an optimized engine that   |\n|supports general computation graphs for data analysis. It also supports a     |\n|rich set of higher-level tools including Spark SQL for SQL and DataFrames,    |\n|MLlib for machine learning, GraphX for graph processing,                      |\n|and Spark Streaming for stream processing.                                    |\n|                                                                              |\n|&lt;http://spark.apache.org/&gt;                                                    |\n+------------------------------------------------------------------------------+\nonly showing top 10 rows\n\nstrings: org.apache.spark.sql.DataFrame = [value: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"strings","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"value","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1651227498290,"submitTime":1651227498263,"finishTime":1651227504179,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",1251]],"subcommandOptions":null,"nuid":"b30107c6-a00e-4062-8e8f-6767bf755696"},{"version":"CommandV1","origId":863457601242059,"guid":"2f96f9e9-c4a9-4517-bfe9-5f242657882f","subtype":"command","commandType":"auto","position":4.0,"command":"strings.count","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res2: Long = 95\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1651227508714,"submitTime":1651227508695,"finishTime":1651227509689,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",43]],"subcommandOptions":null,"nuid":"5d932c02-15ad-4b3a-9860-fb355cbfdc10"},{"version":"CommandV1","origId":863457601242060,"guid":"eea01274-ac59-4c3f-8772-4ee7db6b3f80","subtype":"command","commandType":"auto","position":5.0,"command":"val filtered = strings.filter($\"value\".contains(\"Spark\"))\nfiltered.count","commandVersion":2,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">filtered: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [value: string]\nres3: Long = 17\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"filtered","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"value","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1651227511978,"submitTime":1651227511964,"finishTime":1651227513096,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",126]],"subcommandOptions":null,"nuid":"04ee2a76-524f-4da8-9d88-964b25513b79"},{"version":"CommandV1","origId":2887067133810807,"guid":"06dd314f-9ff2-4d1f-bd1f-fa1af0ebb941","subtype":"command","commandType":"auto","position":6.0,"command":"","commandVersion":0,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"nuid":"a3a89b16-d62a-4d73-8442-7dfd1cac8a3e"}],"dashboards":[],"guid":"b4c869a6-cdcf-43c7-9c81-523b06be8707","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2}}